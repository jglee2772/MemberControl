<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.himedia.mc.ViewDAO">
<insert id="addComment">
	insert into reply set board_id=#{param1}, content=#{param2}, writer=(select id from member where userid=#{param3}),
	updated=current_timestamp, created=current_timestamp
</insert>
<select id="getreplyList" resultType="com.himedia.mc.replyDTO">
	select a.id, b.userid AS writer, a.content, a.created, a.par_id
	from reply a,member b
	where a.writer=b.id
	and a.board_id=#{param1}
</select>
<update id="updateComment">
    UPDATE reply
    SET content = #{param2}, updated = CURRENT_TIMESTAMP
    WHERE id = #{param1}
</update>
<delete id="deleteComment">
    DELETE FROM reply WHERE id = #{param1}
</delete>
<insert id="addReply">
	 insert into reply set board_id=#{param1}, content=#{param3}, writer=(select id from member where userid=#{param4}),
	 par_id=#{param2}, updated=current_timestamp, created=current_timestamp
</insert>
<select id="getparList" resultType="com.himedia.mc.replyDTO">
	select a.id, b.userid AS writer, a.content, a.created, a.par_id
	from reply a,member b
	where a.writer=b.id
	and a.par_id=#{param1}
</select>
</mapper>